---
title: "动态规划-最长的括号子串"
date: 2026-01-24 20:48:47
categories:
  - 算法
tags:
  - 动态规划
draft: false
---

![](https://i-blog.csdnimg.cn/direct/c9f8d5ecb9e1402aa9ce9f78bb0bf717.jpeg)

### 求解代码

```java
public int longestValidParentheses(String s) {
        char[] str = s.toCharArray();
        int[] dp = new int[str.length];
        int ans = 0;
        for (int i = 1, p; i = 0 && str[p] == '(') {
                    dp[i] = dp[i - 1] + 2 + (p - 1 >= 0 ? dp[p - 1] : 0);
                }
            }
            ans = Math.max(ans, dp[i]);
        }
        return ans;
    }
```

### 小贴士

`dp[i]`是以字符串中第`i`个字符`str[i]`结尾的最长有效括号子串的长度。

因为有效括号子串一定是以`)`结尾到，以`(`结尾的子串不可能有效。

所以，只需要处理`str[i] == ')'`的情况，`str[i] == '('`时，让`dp [i] = 0` 即可。

根据定义`dp[i-1]`表示的是以`str[i-1]`结尾的最长有效括号长度， 也就是说从`i-dp[i-1]`到`i-1`的这段子串是有效括号。

那么，要匹配当前的这个`str[i] = ')'`，左括号必须出现在从`i-dp[i-1]`到`i-1`的这段有效子串的前一个位置，这个位置就是`p`，即`i - dp[i-1] - 1`。

`p`指的是当前`)`能形成有效匹配的唯一可能的**左括号位置**。

状态转移方程的含义是：

以`i`结尾的最长有效长度 = 前一个位置`(i-1)`的有效长度 + 当前匹配的一对括号 + 左括号位置`(p)`左边（如果有）的有效长度。
