---
title: "RabbitMQ中的Prefetch参数"
date: 2026-01-11 17:07:58
categories:
- 八股
tags:
- 消息队列
draft: false
---

在RabbitMQ中，prefetch参数主要是用于限制消费者端可以同时**预取并未确认**消息的最大数量，帮助消费者端**控制**消息处理的**流量**。

举个例子说明一下：

如果prefetch的参数设置为1，那么消费者会在未确认消息之前，只预取一个消息，这样可以确保每个消息在被处理成功之后，才接收下一个消息，从而避免消息的积压和资源耗尽。

在**负载均衡**、**避免内存溢出**以及**优先级处理**这些场景下会用到prefetch参数的设置。

比如：

1.RabbitMQ默认轮询分发消息，消费者可以根据其处理能力进行动态地调整prefetch值，实现基于处理能力的动态负载均衡。

2.如果有大量未处理的消息堆积在内存中可能会导致内存溢出，这时通过设置一个较小的prefetch值可以避免这种情况。

3.配合RabbitMQ的优先级队列，设置prefetch值可以确保队列优先推送高优先级的消息，让其被及时处理。


注意⚠️：

prefetch仅在**消费者手动确认消息模式**下生效。
