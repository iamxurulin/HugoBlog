---
title: "【单调队列】滑动窗口的最大值"
date: 2026-01-15 21:58:40
categories:
- 算法
tags:
- leetcode
draft: false
---

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/d9a49ece9bc443c48cb573e83066da96.jpeg#pic_center)
### 求解代码

```java
class MonotonicQueue {
        LinkedList<Integer> queue = new LinkedList<>();
        public void push(int n){
            while(!queue.isEmpty()&&queue.getLast()<n){
                queue.pollLast();
            }
            queue.addLast(n);
        }

        public void pop(int n){
            if(n==queue.getFirst()){
                queue.pollFirst();
            }
        }

        public int max(){
            return queue.getFirst();
        }

    }
    public ArrayList<Integer> maxInWindows (int[] num, int size) {

        MonotonicQueue window = new MonotonicQueue();

        ArrayList<Integer> res = new ArrayList<>();        
        if(num==null||size<=0||num.length==0||size>num.length){
            return res;
        }


        for(int i=0;i<num.length;i++){
            if(i<size-1){
                window.push(num[i]);
            }else{
                window.push(num[i]);
                res.add(window.max());
                window.pop(num[i-size+1]);
            }
        }
        return res;
    }
```

### 小贴士

1.构建一个特殊的【单调队列】来充当不断**滑动的窗口**：

这个单调队列的**队首**记录了滑动过程中的最大值（对应max方法），从**队首到队尾**的元素值大小是**单调递减**的；

当**队列为空**或者尾部的元素（getLast）小于要入队的元素时，将该尾部元素弹出（pollLast）,元素是从队列尾部入队的（addLast）。

当**滑动窗口需要移除的元素**等于队列头部（当前最大值）时，将队首元素弹出（pollFirst）；

2.解释一下这个`i-size+1`

对于长度固定为`size`的滑动窗口，当窗口还没填满时，不考虑计算最大值和移除元素，直到把前`size-1`个元素填满；

从第`size`个元素开始（对应就是下标`size-1`），窗口正式填满，此时，依次完成把当前元素加入窗口，将窗口的最大值记录到`res`中，再把**窗口最左侧的元素**移除，为下一步滑动腾出一个位置。

那窗口最左侧元素的下标是什么呢？

因为当前元素是`num[i]`，所以此时的窗口的右边界是`i`，又因为窗口的大小固定为`size`，所以，窗口的左边界就是`i-size+1`，这也就是我们要移除的**窗口最左侧元素的下标**。


