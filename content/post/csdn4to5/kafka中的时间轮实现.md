---
title: "kafka中的时间轮实现"
date: 2025-12-29 15:49:00
categories:
- 八股
tags:
  - 消息队列
draft: false
---

Kafka中的时间轮是一种用于实现**定时清理**、**消息过期**、**心跳超时**等功能的定时任务调度机制。

通过时间轮可以避免在大量的定时任务中进行逐个扫描，可以实现接近**O(1)**的延迟任务管理，降低了内存和CPU的消耗，比较适合管理大量**短时和中长期的定时任务**。

时间轮，它可以看成是一个**环形数组**，其中，每个槽表示一个时间间隔。

Kafka会在时间轮的每个槽中根据**任务的到期时间**放置延迟任务，当时间轮转到任务所在的槽时，就执行该槽内的任务。

如果存在到期未完成的任务，则会被**重新分配到下一轮**。


