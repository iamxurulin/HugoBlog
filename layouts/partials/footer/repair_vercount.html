<script>
    (function() {
        function reloadVercount() {
            console.log('ğŸ”µ [Vercount] å¼€å§‹é‡è½½...');
            
            const container = document.querySelector('.article-view');
            // å¦‚æœä¸æ˜¯æ–‡ç« é¡µï¼Œéšè—å¹¶é€€å‡º
            if (!container) { 
                document.querySelectorAll('.article-view').forEach(el => el.style.display = 'none');
                return; 
            }
            container.style.display = 'flex';

            // 1. æ¸…ç†æ—§ IDï¼Œé˜²æ­¢å†²çª
            document.querySelectorAll('[id^="busuanzi_"]').forEach(el => el.removeAttribute('id'));

            // 2. ç»‘å®šæ–° ID
            const pvContainer = container.querySelector('.temp-pv-container');
            const pvValue = container.querySelector('.temp-pv-value');
            if (pvContainer) pvContainer.id = 'busuanzi_container_page_pv';
            if (pvValue) {
                pvValue.id = 'busuanzi_value_page_pv';
                pvValue.textContent = '...';
            }

            // 3. ç§»é™¤æ—§è„šæœ¬ (å¦‚æœæœ‰)
            const oldScript = document.getElementById('vercount-script');
            if (oldScript) oldScript.remove();

            // 4. æ¸…é™¤å…¨å±€å¯¹è±¡ (å¼ºåˆ¶é‡ç½®)
            if (window.busuanzi) delete window.busuanzi;

            // 5. â˜…â˜…â˜… æ ¸å¿ƒä¿®å¤ï¼šåˆ›å»ºæ–°è„šæœ¬å¹¶åŠ æ—¶é—´æˆ³ â˜…â˜…â˜…
            const script = document.createElement('script');
            // åŠ æ—¶é—´æˆ³ ?t=... å¼ºåˆ¶æµè§ˆå™¨ä¸ä½¿ç”¨ç¼“å­˜ï¼Œå¿…é¡»é‡æ–°æ‰§è¡Œè„šæœ¬
            script.src = "https://cn.vercount.one/js?t=" + new Date().getTime();
            script.id = "vercount-script";
            script.async = true;
            script.defer = true; // ç¡®ä¿æŒ‰é¡ºåºæ‰§è¡Œ
            
            document.head.appendChild(script);
            console.log('âœ… [Vercount] è„šæœ¬å·²æ’å…¥ (å¸¦æ—¶é—´æˆ³)');
        }

        // åˆå§‹åŒ–
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', reloadVercount);
        } else {
            reloadVercount();
        }
        
        // PJAX ç›‘å¬
        document.addEventListener('pjax:complete', reloadVercount);
    })();
</script>